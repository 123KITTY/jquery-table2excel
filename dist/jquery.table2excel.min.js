/*
 *  jQuery table2excel - v1.0.2
 *  jQuery plugin to export an .xls file in browser from an HTML table
 *  https://github.com/rainabba/jquery-table2excel
 *
 *  Made by rainabba
 *  Under MIT License
 */
!function(a,b,c,d){function e(b,c){this.element=b,this.settings=a.extend({},g,c),this._defaults=g,this._name=f,this.init()}var f="table2excel",g={exclude:".noExl",name:"Table2Excel"};e.prototype={init:function(){var b=this;b.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>',sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"},b.tableRows=[],a(b.element).each(function(c,d){var e="";a(d).find("tr").not(b.settings.exclude).each(function(b,c){e+="<tr>"+a(c).html()+"</tr>"}),b.tableRows.push(e)}),b.tableToExcel(b.tableRows,b.settings.name)},tableToExcel:function(c,d){var e,f=this,g="";if(f.uri="data:application/vnd.ms-excel;base64,",f.base64=function(a){return b.btoa(unescape(encodeURIComponent(a)))},f.format=function(a,b){return a.replace(/{(\w+)}/g,function(a,c){return b[c]})},f.ctx={worksheet:d||"Worksheet",table:c},g=f.template.head,a.isArray(c))for(e in c)g+=f.template.sheet.head+"Table"+e+f.template.sheet.tail;if(g+=f.template.mid,a.isArray(c))for(e in c)g+=f.template.table.head+"{table"+e+"}"+f.template.table.tail;g+=f.template.foot;for(e in c)f.ctx["table"+e]=c[e];delete f.ctx.table,b.location.href=f.uri+f.base64(f.format(g,f.ctx))}},a.fn[f]=function(b){var c=this;return c.each(function(){a.data(c,"plugin_"+f)||a.data(c,"plugin_"+f,new e(this,b))}),c}}(jQuery,window,document);