/*
 *  jQuery table2excel - v1.0.2
 *  jQuery plugin to export an .xls file in browser from an HTML table
 *  https://github.com/rainabba/jquery-table2excel
 *
 *  Made by rainabba
 *  Under MIT License
 */
!function(a,b,c,d){function e(b,c){this.element=b,this.settings=a.extend({},g,c),this._defaults=g,this._name=f,this.init()}var f="table2excel",g={exclude:".noExl",name:"Table2Excel"};e.prototype={init:function(){var b=this;b.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>',sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"},b.tableRows=[],a(b.element).each(function(c,d){var e="";a(d).find("tr").not(b.settings.exclude).each(function(b,c){e+="<tr>"+a(c).html()+"</tr>"}),b.tableRows.push(e)}),b.tableToExcel(b.tableRows,b.settings.name)},tableToExcel:function(d,e){var f,g,h,i=this,j="";if(i.uri="data:application/vnd.ms-excel;base64,",i.base64=function(a){return b.btoa(unescape(encodeURIComponent(a)))},i.format=function(a,b){return a.replace(/{(\w+)}/g,function(a,c){return b[c]})},i.ctx={worksheet:e||"Worksheet",table:d},j=i.template.head,a.isArray(d))for(f in d)j+=i.template.sheet.head+"Table"+f+i.template.sheet.tail;if(j+=i.template.mid,a.isArray(d))for(f in d)j+=i.template.table.head+"{table"+f+"}"+i.template.table.tail;j+=i.template.foot;for(f in d)i.ctx["table"+f]=d[f];delete i.ctx.table,g=i.uri+i.base64(i.format(j,i.ctx)),h=c.createElement("a"),h.download=(i.settings.filename?i.settings.filename:"table2excel")+".xlsx",h.href=g,h.click()}},a.fn[f]=function(b){var c=this;return c.each(function(){a.data(c,"plugin_"+f)||a.data(c,"plugin_"+f,new e(this,b))}),c}}(jQuery,window,document);